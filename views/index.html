<!DOCTYPE html>
<html>
  <head>
    <title>{% block title %}Blackjack{% endblock %}</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
  </head>
  <body>
  	{% block header %}
  		<div id="header" style='width:100%;height:50px;'>
	  		{% if showMessage == true %}
	  		<h4 style="display:inline;float:left;margin-left:5%;">{{message}}</h4>
	  		{% endif %}
  			<h1 style="color:green;display:inline;float:right;margin:auto 5% 5% auto;cursor:pointer;">+</h1>
  		</div>
  	{% endblock %}
  	{% block content %}
  		<div id='table'>
  			{% if showDeck == true %}
  				<div id='deck'>
  					<h4>{{totalCards}}</h4>
  				</div>
  			{% endif %}
  			{% for player in players %}
  				{% if player.name != "dealer" %}
  				<div class='player' style="margin:{{player.tablePos.top}} auto auto {{player.tablePos.left}};" id='{{player.name}}'>
  					<h4>{{player.name}}</h4>
  					<div id='{{player.name}}shand'>
  						{{player.handsValue}}
  					</div>
  					<div id='{{player.name}}sbank'>
  						{{player.funds}}
  					</div>
  					<div id='{{player.name}}sbet'>
  						{{player.bet}}
  					</div>
  				</div>
  				{% else %}
  				<div class='player' style="margin: -27.5% auto auto 47.5%;"id='{{player.name}}'>
  					<h4>{{player.name}}</h4>
  					<div id='{{player.name}}shand'>
  						{{player.handsValue}}
  					</div>
  				</div>
  				{% endif %}
  			{% endfor %}
  		</div>
  	{% endblock %}
  	<script src="/socket.io/socket.io.js"></script>
    <script>
      // load the socket.io library above, the connect to the server
      // because the socket.io server is being run on the same server as your 
      // express instance, you can connect() without any additional information
      var socket = io.connect(); // TIP: .connect with no args does auto-discovery

      // when 'new_tweet' events are fired, take our fileobj object and do something with it
      socket.on('new_tweet', function (new_tweet) { 
        var mainDiv = '<div class="media" style="cursor:pointer;" onclick="window.location.href = \'/users/' + new_tweet.name + '/tweets/' + new_tweet.id + '\'"></div>';
        var avatar = '<div class="media-left"><a href="#"><img class="media-object" src="http://www.jammaplus.co.uk/forum/uploads/5237/Paper-Mario-icon.png"></a></div>';
        var bodyDiv = '<div class="media-body"><h4 class="media-heading"><a href="/users/' + new_tweet.name + '">' + new_tweet.name + '</a></h4><p>' + new_tweet.text + '</p><a href="#">Re-tweet</a></div>'

        mainDiv.append(avatar);
        mainDiv.append(bodyDiv);
        $('#tweet-wrapper').append(mainDiv);
        // console.log(new_tweet);
        // alert('Refreshing... check the console...');
        // add logic to load the new tweet
      }); 
    </script>
  </body>
</html>